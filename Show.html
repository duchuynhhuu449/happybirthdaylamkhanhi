<!DOCTYPE html>
<html lang="vi">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>üéÇ Ch√∫c m·ª´ng sinh nh·∫≠t ‚Äì Nguy·ªÖn Th·ªã B√≠ch Y√™n</title>
    <link href="https://fonts.googleapis.com/css2?family=Dancing+Script:wght@700&display=swap" rel="stylesheet">
    <style>
        *,
        *::before,
        *::after {
            box-sizing: border-box;
        }

        html,
        body {
            height: 100dvh;
            /* Safari iOS m·ªõi */
            margin: 0;
            font-family: 'Dancing Script', cursive, 'Courier New', monospace;
            background: url('./assets/img/BirthdayCommingSoon.png') center/cover no-repeat;
            color: #fff;
            overflow: hidden;
            -webkit-font-smoothing: antialiased;
        }

       

        /* rotate hint (b·∫Øt xoay ngang tr√™n mobile) */
        .rotateNotice {
            position: fixed;
            inset: 0;
            display: none;
            z-index: 200;
            background: rgba(0, 0, 0, 0.95);
            color: #fff;
            align-items: center;
            justify-content: center;
            text-align: center;
            padding: 20px;
        }

        .rotateNotice.show {
            display: flex;
        }

        .rotateNotice h2 {
            font-size: 22px;
            margin-bottom: 8px;
        }

        .rotateNotice p {
            opacity: .9;
        }

        /* Overlay m·ªù */
        .overlay {
            position: fixed;
            inset: 0;
            background: rgba(0, 0, 0, 0.45);
            z-index: 2;
            transition: opacity 900ms ease;
        }

        .stage {
            position: fixed;
            inset: 0;
            display: grid;
            place-items: center;
            padding: 24px;
            z-index: 10;
        }

        .card {
            max-width: 1000px;
            width: calc(100% - 48px);
            background: rgba(0, 0, 0, 0.55);
            border-radius: 20px;
            padding: 36px;
            text-align: left;
            position: relative;
            box-shadow: 0 12px 50px rgba(0, 0, 0, 0.6);
            z-index: 20;
            overflow: visible;
        }

        /* Heading n·ªïi b·∫≠t */
        .headline {
            font-size: 36px;
            text-align: center;
            margin-bottom: 18px;
            background: linear-gradient(90deg, #ffd166, #ff9bce);
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
            text-shadow: 0 6px 18px rgba(0, 0, 0, 0.45);
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }

        .headline .icon {
            font-size: 34px;
            transform: translateY(2px);
        }

        .content {
            font-size: 28px;
            line-height: 1.45;
            min-height: 12em;
            color: #fff;
            display: flex;
            align-items: center;
        }

        .typewriter {
            display: inline-block;
            white-space: pre-wrap;
            max-width: 92%;
            margin: 0 auto;
        }

        /* Caret: d√πng pseudo-element ƒë·ªÉ lu√¥n d√≠nh s√°t cu·ªëi ch·ªØ, m∆∞·ª£t*/
        .typewriter::after {
            content: '|';
            display: inline-block;
            margin-left: 0.04em;
            opacity: 1;
            animation: blink 1s steps(1, end) infinite;
            vertical-align: bottom;
            font-weight: 700;
        }

        @keyframes blink {
            50% {
                opacity: 0
            }
        }

        /* Countdown & progress (g·ªçn, kh√¥ng l√†m gi·∫≠t m·∫Øt) */
        .bottomBar {
            position: absolute;
            left: 20px;
            right: 20px;
            bottom: 16px;
            display: flex;
            align-items: center;
            gap: 12px;
            z-index: 30;
        }

        .progress {
            flex: 1;
            height: 8px;
            background: rgba(255, 255, 255, 0.08);
            border-radius: 8px;
            overflow: hidden;
            position: relative;
        }

        .progressInner {
            width: 0%;
            height: 100%;
            background: linear-gradient(90deg, #ff9bce, #ffd166);
            transition: width linear;
        }

        .progText {
            min-width: 48px;
            text-align: center;
            font-size: 14px;
            background: rgba(255, 255, 255, 0.06);
            padding: 6px 10px;
            border-radius: 999px;
        }

        /* Bong b√≥ng 2 b√™n, nh·ªè v√† m·ªù, tr√°nh ph·∫ßn trung t√¢m (kh√¥ng che text) */
        .balloons {
            position: fixed;
            inset: 0;
            pointer-events: none;
            z-index: 5;
        }

        .balloon {
            position: absolute;
            bottom: -120px;
            border-radius: 50%;
            opacity: 0.9;
            transform-origin: center bottom;
            filter: blur(.2px);
        }

        @keyframes floatUp {
            0% {
                transform: translateY(0) translateX(0) rotate(0deg);
                opacity: 1
            }

            100% {
                transform: translateY(-140vh) translateX(20px) rotate(360deg);
                opacity: .06
            }
        }

        /* K·∫øt th√∫c: b√°nh + ·∫£nh */
        .celebrate {
            position: fixed;
            inset: 0;
            display: grid;
            place-items: center;
            background: rgba(0, 0, 0, 0.92);
            color: #fff;
            z-index: 60;
            opacity: 0;
            pointer-events: none;
            transition: opacity 900ms ease;
        }

        .celebrate.show {
            opacity: 1;
            pointer-events: auto;
        }

        .finalWrap {
            text-align: center;
            position: relative;
        }

        .orbit {
            position: relative;
            width: 520px;
            height: 520px;
            margin: 20px auto 0;
        }

        .orbit .cake {
            position: absolute;
            left: 50%;
            top: 50%;
            transform: translate(-50%, -50%);
            width: 260px;
            height: 260px;
            background: url('./assets/img/HappyBirthDay.png') center/contain no-repeat;
            z-index: 30;
        }

        .orbit img {
            position: absolute;
            width: 110px;
            height: 110px;
            border-radius: 12px;
            object-fit: cover;
            border: 4px solid rgba(255, 255, 255, 0.12);
            box-shadow: 0 8px 30px rgba(0, 0, 0, 0.6);
            transform-origin: center;
        }

        .finalText {
            margin-top: 18px;
            font-size: 22px;
        }

        /* fade cho t·ª´ng ƒëo·∫°n ƒë·ªÉ m∆∞·ª£t */
        .fadeIn {
            animation: fadeIn 420ms ease both;
        }

        .fadeOut {
            animation: fadeOut 320ms ease both;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(6px);
            }

            to {
                opacity: 1;
                transform: none;
            }
        }

        @keyframes fadeOut {
            from {
                opacity: 1;
            }

            to {
                opacity: 0;
                transform: translateY(-6px);
            }
        }

        @media (max-width: 820px) {
            .content {
                font-size: 22px;
            }

            .orbit {
                width: 360px;
                height: 360px;
            }

            .orbit img {
                width: 80px;
                height: 80px;
            }

            .headline {
                font-size: 28px;
            }
        }
    </style>
</head>

<body>
    <!-- rotate overlay -->
    <div class="rotateNotice" id="rotateNotice">
        <div>
            <h2>Xoay ngang m√†n h√¨nh ƒë·ªÉ xem tr√¨nh chi·∫øu</h2>
            <p>Tr√¨nh chi·∫øu ƒë·∫πp h∆°n khi xoay ngang (landscape). Vui l√≤ng xoay ƒëi·ªán tho·∫°i ƒë·ªÉ ti·∫øp t·ª•c.</p>
        </div>
    </div>

    <div class="overlay" id="overlay"></div>
    <div class="balloons" id="balloons"></div>

    <audio id="bgm" preload="auto" loop></audio>

    <div class="stage">
        <div class="card" id="card">
            <div class="headline"><span class="icon">üéâ</span><span>Ch√∫c m·ª´ng sinh nh·∫≠t Nguy·ªÖn Th·ªã B√≠ch Y√™n</span></div>
            <div class="content">
                <span class="typewriter" id="tw"></span>
            </div>

            <div class="bottomBar">
                <div class="progress" id="progressBar" aria-hidden="true">
                    <div class="progressInner" id="progressInner"></div>
                </div>
                <div class="progText" id="progText">0s</div>
            </div>
        </div>
    </div>

    <div class="celebrate" id="celebrate">
        <div class="finalWrap">
            <div class="orbit" id="orbit">
                <div class="cake"></div>
            </div>
            <div class="finalText" id="finalText">C√πng nhau l∆∞u gi·ªØ kho·∫£nh kh·∫Øc ƒë·∫∑c bi·ªát t·∫°i ƒë√¢y nh√©</div>
        </div>
    </div>

    <script>
        // ====== C·∫•u h√¨nh ======
        const DEFAULT_MUSIC = 'media/happy-birthday-piano.mp3';

        // K·ªãch b·∫£n (ng√¥i tui - b√†), m·∫°ch vƒÉn n·ªëi h∆°n, kh√¥ng d·∫•u '-' v√† ng·∫Øn/ d√†i h·ª£p l√Ω
        const script = [
            { text: "Kho·∫£nh kh·∫Øc m√† tui ch·ªù t·ª´ l√¢u cu·ªëi c√πng c≈©ng t·ªõi. H√¥m nay l√† ng√†y c·ªßa b√† ‚Äî v√† tui mu·ªën d√†nh c·∫£ t·∫•m l√≤ng n√†y ƒë·ªÉ n√≥i nh·ªØng ƒëi·ªÅu th·∫≠t gi·∫£n d·ªã nh∆∞ng ch√¢n th√†nh.", hold: 6000 },
            { text: "Nguy·ªÖn Th·ªã B√≠ch Y√™n", hold: 3000 },
            { text: "08/09/2004", hold: 3000 },
            { text: "H√¥m nay b√† 22 tu·ªïi. Tu·ªïi c·ªßa nh·ªØng kh·ªüi ƒë·∫ßu, c·ªßa nh·ªØng d·ª± ƒë·ªãnh c√≤n dang d·ªü v√† nh·ªØng ∆∞·ªõc m∆° c√≤n ch∆∞a k·ªãp n√≥i.", hold: 5500 },
            { text: "Ch√∫c b√† m·ªôt ng√†y th·∫≠t tr·ªçn v·∫πn. Tui mong b√† lu√¥n th·∫•y ·∫•m √°p, lu√¥n c√≥ ti·∫øng c∆∞·ªùi v√† lu√¥n c·∫£m th·∫•y an to√†n b√™n nh·ªØng ng∆∞·ªùi y√™u th∆∞∆°ng.", hold: 7000 },
            { text: "H√£y c·ª© d≈©ng c·∫£m theo ƒëu·ªïi nh·ªØng ƒëi·ªÅu b√† mu·ªën. Tui tin b√† l√†m ƒë∆∞·ª£c ‚Äî v√† tui ·ªü ƒë√¢y, √¢m th·∫ßm c·ªï v≈©, n·∫Øm ch·∫∑t ni·ªÅm tin ·∫•y c√πng b√†.", hold: 6500 },
            { text: "C√≥ m·ªôt ƒëi·ªÅu tui gi·ªØ trong l√≤ng l√¢u r·ªìi. Tui th√≠ch c√°ch b√† c∆∞·ªùi, th√≠ch c√°ch b√† d·ªãu d√†ng v·ªõi m·ªçi ng∆∞·ªùi, v√† t·ª± nhi√™n tui mu·ªën ƒë∆∞·ª£c g·∫ßn b√† h∆°n n·ªØa.", hold: 9000 },
            { text: "N·∫øu b√† cho ph√©p, tui mu·ªën ƒë∆∞·ª£c n·∫Øm tay b√† trong nh·ªØng ng√†y b√¨nh th∆∞·ªùng l·∫´n nh·ªØng ng√†y ƒë·∫∑c bi·ªát. Kh√¥ng v·ªôi, ch·ªâ ch√¢n th√†nh v√† ki√™n nh·∫´n.", hold: 8000 },
            { text: "Mong tu·ªïi m·ªõi s·∫Ω m·ªü ra nh·ªØng ni·ªÅm vui kh√¥ng ng·ªù, nh·ªØng k·ª∑ ni·ªám ng·ªçt ng√†o v√† nh·ªØng ng∆∞·ªùi b·∫°n th·∫≠t l√≤ng ƒë·ªìng h√†nh c√πng b√†.", hold: 5500 },
            { text: "M·ªôt l·∫ßn n·ªØa, ch√∫c m·ª´ng sinh nh·∫≠t b√†. H√£y ƒë·ªÉ h√¥m nay l√† kh·ªüi ƒë·∫ßu cho m·ªçi ƒëi·ªÅu t·ªët ƒë·∫πp v√† cho nh·ªØng y√™u th∆∞∆°ng s·∫Ω ƒë·∫øn.", hold: 6500 }
        ];

        // DOM
        const twEl = document.getElementById('tw');
        const progressInner = document.getElementById('progressInner');
        const progText = document.getElementById('progText');
        const celebrate = document.getElementById('celebrate');
        const balloonsWrap = document.getElementById('balloons');
        const bgm = document.getElementById('bgm');
        const overlay = document.getElementById('overlay');
        const rotateNotice = document.getElementById('rotateNotice');

        // Music c·ªë ƒë·ªãnh (th·ª≠ play, nh∆∞ng browser c√≥ th·ªÉ ch·∫∑n autoplay v·ªõi √¢m thanh)
        bgm.src = DEFAULT_MUSIC;
        bgm.volume = 0.8;

        // --- ROTATE / MOBILE handling ---
        function isLandscape() {
            return window.innerWidth > window.innerHeight;
        }
        let started = false;
        function checkOrientationAndStart() {
            if (!isLandscape() && /Mobi|Android|iPhone|iPad/i.test(navigator.userAgent)) {
                // show rotate overlay and pause
                rotateNotice.classList.add('show');
                overlay.style.opacity = '1';
                return false;
            } else {
                rotateNotice.classList.remove('show');
                overlay.style.opacity = '0.45';
                if (!started) {
                    // start audio & script
                    bgm.play().catch(() => { });
                    started = true;
                    runScript();
                }
                return true;
            }
        }
        window.addEventListener('resize', checkOrientationAndStart);
        window.addEventListener('orientationchange', () => setTimeout(checkOrientationAndStart, 400));

        // --- Balloons: t·∫°o 2 b√™n, tr√°nh che ph·∫ßn trung t√¢m ---
        function createBalloons() {
            const count = 18;
            for (let i = 0; i < count; i++) {
                const b = document.createElement('div');
                b.className = 'balloon';
                const size = 24 + Math.random() * 40;
                b.style.width = b.style.height = size + 'px';
                // tr√°nh v√πng center 28%-72%
                const side = Math.random() < 0.5 ? 'left' : 'right';
                if (side === 'left') b.style.left = (4 + Math.random() * 18) + '%';
                else b.style.left = (78 + Math.random() * 17) + '%';
                b.style.background = `radial-gradient(circle at 35% 30%, rgba(255,255,255,0.95), rgba(255,182,193,0.85))`;
                const dur = 10 + Math.random() * 12;
                b.style.animation = `floatUp ${dur}s linear ${Math.random() * 3}s infinite`;
                b.style.opacity = 0.9 - Math.random() * 0.45;
                balloonsWrap.appendChild(b);
            }
        }
        createBalloons();

        // --- TYPEWRITER with smooth fade transitions, center short lines ---
        function isShortText(s) {
            return s.replace(/\s+/g, ' ').trim().length < 40;
        }

        function fadeInEl(el) {
            el.classList.remove('fadeOut');
            el.classList.add('fadeIn');
        }
        function fadeOutEl(el) {
            el.classList.remove('fadeIn');
            el.classList.add('fadeOut');
        }

        function typeText(text, perChar = 40) {
            return new Promise(resolve => {
                // align center if short
                const card = document.getElementById('card');
                if (isShortText(text)) {
                    card.querySelector('.content').style.justifyContent = 'center';
                    card.querySelector('.content').style.textAlign = 'center';
                } else {
                    card.querySelector('.content').style.justifyContent = 'center';
                    card.querySelector('.content').style.textAlign = 'left';
                }

                twEl.textContent = '';
                // small fade-in
                fadeInEl(twEl);
                let i = 0;
                const chars = [...text];
                const timer = setInterval(() => {
                    twEl.textContent += chars[i++] || '';
                    if (i >= chars.length) { clearInterval(timer); resolve(); }
                }, perChar);
            });
        }

        function deleteText(perChar = 28) {
            return new Promise(resolve => {
                // fade slightly
                // remove trailing characters one by one
                const timer = setInterval(() => {
                    const txt = twEl.textContent;
                    if (!txt || txt.length === 0) { clearInterval(timer); resolve(); return; }
                    twEl.textContent = txt.slice(0, -1);
                }, perChar);
            });
        }

        // Hold with subtle progress: animate progressInner width from 0% -> 100%
        function holdWithCountdown(ms) {
            return new Promise(resolve => {
                const total = Math.max(0, ms);
                let remaining = Math.ceil(total / 1000);
                progText.textContent = remaining + 's';
                // animate from 0 -> 100%
                progressInner.style.transition = `width ${total}ms linear`;
                progressInner.style.width = '0%';
                // force reflow
                void progressInner.offsetWidth;
                progressInner.style.width = '100%';
                const interval = setInterval(() => {
                    remaining--;
                    progText.textContent = (remaining > 0 ? remaining + 's' : '0s');
                }, 1000);
                setTimeout(() => {
                    clearInterval(interval);
                    // reset progress for next use (set to 0 instantly)
                    progressInner.style.transition = 'none';
                    progressInner.style.width = '0%';
                    progText.textContent = '';
                    resolve();
                }, total);
            });
        }

        // RUN script: fade out previous, type new, hold, delete
        async function runScript() {
            for (let i = 0; i < script.length; i++) {
                const seg = script[i];
                // fade out previous text (if any)
                if (twEl.textContent) {
                    fadeOutEl(twEl);
                    await new Promise(r => setTimeout(r, 280));
                    twEl.textContent = '';
                }
                await typeText(seg.text, 40);
                await holdWithCountdown(seg.hold);
                await deleteText(28);
                await new Promise(r => setTimeout(r, 240));
            }
            // hide caret (caret is pseudo-element; hide by making twEl opacity 0)
            twEl.style.opacity = '0';
            // gentle overlay dark then show final
            overlay.style.transition = 'opacity 900ms ease';
            overlay.style.opacity = '1';
            await new Promise(r => setTimeout(r, 700));
            showFinal();
        }

        // Show final cake + orbit images + confetti
        function showFinal() {
            celebrate.classList.add('show');
            // Create n images around center
            const orbit = document.getElementById('orbit');
            orbit.innerHTML = '<div class="cake"></div>'; // reset + cake in center
            const n = 6; // s·ªë ·∫£nh (b·∫°n mu·ªën 7 -> ƒë·ªïi n)
            const radius = Math.min(200, orbit.clientWidth * 0.38);
            for (let i = 0; i < n; i++) {
                const img = document.createElement('img');
                img.src = `https://via.placeholder.com/200x200?text=·∫¢nh+${i + 1}`;
                img.style.opacity = '0';
                orbit.appendChild(img);
                // ƒë·∫∑t v·ªã tr√≠ ch√≠nh x√°c sau append (clientWidth/Height c√≥ gi√° tr·ªã)
                const angle = (i / n) * Math.PI * 2 - Math.PI / 2; // b·∫Øt ƒë·∫ßu t·ª´ tr√™n
                const cx = orbit.clientWidth / 2;
                const cy = orbit.clientHeight / 2;
                const x = cx + Math.cos(angle) * radius - (img.width / 2 || 55);
                const y = cy + Math.sin(angle) * radius - (img.height / 2 || 55);
                img.style.left = x + 'px';
                img.style.top = y + 'px';
                img.style.transition = `transform 700ms ease ${i * 90}ms, opacity 700ms ease ${i * 90}ms`;
                setTimeout(() => {
                    img.style.opacity = '1';
                    img.style.transform = 'translateY(-8px)';
                }, 200 + i * 90);
            }
            // confetti (subtle)
            launchConfetti();
        }

        // Simple confetti (canvas-less, small colored dots)
        function launchConfetti() {
            const wrap = document.createElement('div');
            wrap.style.position = 'fixed';
            wrap.style.left = '0';
            wrap.style.top = '0';
            wrap.style.width = '100%';
            wrap.style.height = '100%';
            wrap.style.pointerEvents = 'none';
            wrap.style.zIndex = 120;
            document.body.appendChild(wrap);
            const colors = ['#ff8fc3', '#ffd166', '#7ef0c7', '#ffd5f0', '#b3e5ff'];
            const pieces = 40;
            for (let i = 0; i < pieces; i++) {
                const d = document.createElement('div');
                const size = 6 + Math.random() * 12;
                d.style.width = d.style.height = size + 'px';
                d.style.background = colors[Math.floor(Math.random() * colors.length)];
                d.style.position = 'absolute';
                d.style.left = (30 + Math.random() * 40) + '%';
                d.style.top = (40 + Math.random() * 20) + '%';
                d.style.opacity = '1';
                d.style.borderRadius = (Math.random() > 0.6 ? '0' : '50%');
                d.style.transform = `translateY(0) rotate(${Math.random() * 360}deg)`;
                d.style.transition = `transform ${1200 + Math.random() * 900}ms cubic-bezier(.2,.8,.2,1), opacity 1200ms linear`;
                wrap.appendChild(d);
                setTimeout(() => {
                    d.style.transform = `translate(${(-120 + Math.random() * 240)}px, ${-700 - Math.random() * 200}px) rotate(${Math.random() * 720}deg)`;
                    d.style.opacity = '0';
                }, 80 + i * 20);
            }
            // remove after animation
            setTimeout(() => wrap.remove(), 2600);
        }

        // Start when page loaded and orientation ok
        window.addEventListener('load', () => {
            // try to play bgm (may be blocked)
            bgm.play().catch(() => { });
            // check orientation and start only when landscape on mobile or always on desktop
            checkOrientationAndStart();
        });

        // External helper: update orbit photos after final shown
        window.updatePhotos = function (urls) {
            const orbit = document.getElementById('orbit');
            const imgs = orbit.querySelectorAll('img');
            for (let i = 0; i < imgs.length && i < urls.length; i++) {
                imgs[i].src = urls[i] || imgs[i].src;
            }
        };

    </script>
</body>

</html>